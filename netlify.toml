[[edge_functions]]
  path = "/rsvp/*"
  function = "attendee_status"


[dev]
# Just run netlify dev -d app/build/
  command = "flask run"
  targetPort = 5000


[functions]
  node_bundler = "esbuild"


[build]
	functions = "netlify/functions/"
	MISE_VERBOSE=1
	command = "python freeze.py"
	publish = "app/build"
	environment = { PYTHON_VERSION = "3.12" }


[[plugins]]
  package = "netlify-plugin-image-optim"
  [plugins.inputs]
    # Optimize cached event images for mobile
    quality = 80

[[plugins]]
  package = "netlify-plugin-minify-html"
  [plugins.inputs]
    contexts = ["production"]

[[plugins]]
  package = "netlify-plugin-cache"
  [plugins.inputs]
    # Cache Python packages and event images between builds
    paths = [
      ".cache/pip",
      "app/static/images/events"
    ]

[[plugins]]
  package = "@netlify/plugin-sitemap"


[[headers]]
  for = "/static/*"
  [headers.values]
    Cache-Control = "public, max-age=1209600, immutable"

[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "public, max-age=3600, must-revalidate"

[[headers]]
  for = "/*"
  [headers.values]
    X-Content-Type-Options = "nosniff"
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"


[template.environment]
  DATABASE_URL="postgresql://postgres:postgres@localhost:5432/postgres"
  PARTY_NAME="What party are you hosting?"
  TWILIO_ACCOUNT_SID="ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
  TWILIO_AUTH_TOKEN="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
  TWILIO_FROM_Number="+1xxxxxxxxxx"
  SUPERBLOCKS_PROD_WF="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"



